name: ðŸŽ‰ Release Please
on:
  push:
    branches:
      - main
permissions:
  contents: write
  pull-requests: write

jobs:
  release_please:
    name: ðŸ”– Release Please
    runs-on: ubuntu-latest
    steps:
      - name: Create Release
        id: release
        uses: googleapis/release-please-action@v4
        with:
          config-file: .github/release-please-config.json
          manifest-file: .github/.release-please-manifest.json
    outputs:
      extension_release_created: ${{ steps.release.outputs['septic-config--release_created'] }}
      core_package_release_created: ${{ steps.release.outputs['septic--release_created'] }}
  publish_extension:
    name: "Publish Extension"
    if: ${{ needs.release_please.outputs.extension_release_created }}
    needs: [release_please]
    uses: ./.github/workflows/publish-extension.yml
  publish_core_package:
    name: "Publish Core Package"
    if: ${{ needs.release_please.outputs.core_package_release_created }}
    needs: [release_please]
    uses: ./.github/workflows/publish-core-package.yml
